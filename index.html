<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jura Arcade</title>
    <style>
        :root {
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --text: #1C1C1E;
            --sub: #8E8E93;
            --blue: #007AFF;
            --red: #FF3B30;
            --green: #34C759;
            --orange: #FF9500;
            --radius: 24px;
            --shadow: 0 12px 40px rgba(0,0,0,0.12);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- HUD --- */
        .hud {
            width: 90%;
            max-width: 450px;
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            z-index: 10;
        }

        .lives {
            font-size: 20px;
            letter-spacing: 2px;
        }

        .score-container {
            text-align: center;
        }

        .score {
            font-size: 24px;
            font-variant-numeric: tabular-nums;
        }

        .combo {
            font-size: 12px;
            color: var(--orange);
            opacity: 0;
            transition: opacity 0.2s, transform 0.2s;
        }
        .combo.active { opacity: 1; transform: scale(1.1); }

        .progress-bar-bg {
            width: 90%;
            max-width: 450px;
            height: 6px;
            background: #E5E5EA;
            border-radius: 10px;
            margin: 10px 0 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--blue);
            width: 0%;
            transition: width 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* --- GAME SCENE --- */
        .scene {
            width: 90%;
            max-width: 400px;
            flex-grow: 1;
            max-height: 60vh;
            perspective: 1200px;
            position: relative;
            cursor: pointer;
        }

        .card {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            border-radius: var(--radius);
            background: var(--card);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            box-sizing: border-box;
            text-align: center;
        }

        .face.back {
            transform: rotateY(180deg);
            background: #FDFDFF;
            border: 2px solid var(--blue);
        }

        .tag {
            position: absolute;
            top: 25px;
            background: #F2F2F7;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--sub);
            letter-spacing: 0.5px;
        }

        h2 {
            font-size: 22px;
            line-height: 1.4;
            margin: 0;
        }

        p {
            font-size: 18px;
            line-height: 1.5;
            color: #3A3A3C;
        }

        .tap-hint {
            position: absolute;
            bottom: 25px;
            font-size: 13px;
            color: var(--sub);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        /* --- CONTROLS --- */
        .controls {
            width: 100%;
            max-width: 400px;
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(20px);
            transition: all 0.3s;
        }

        .controls.active {
            opacity: 1;
            pointer-events: all;
            transform: translateY(0);
        }

        .btn {
            flex: 1;
            border: none;
            padding: 18px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .btn:active { transform: scale(0.96); }

        .btn-wrong {
            background: #FFF2F2;
            color: var(--red);
        }
        
        .btn-right {
            background: var(--blue);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 122, 255, 0.3);
        }

        /* --- SCREENS --- */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            display: none; /* hidden by default */
        }

        .overlay h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .overlay p {
            max-width: 300px;
            margin-bottom: 30px;
            color: var(--sub);
        }

        .big-btn {
            background: var(--text);
            color: white;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            border: none;
            cursor: pointer;
        }

        /* --- FX --- */
        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

    </style>
</head>
<body>

    <div class="hud">
        <div class="lives" id="livesDisplay">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        <div class="score-container">
            <div class="score" id="scoreDisplay">0</div>
            <div class="combo" id="comboDisplay">COMBO x2</div>
        </div>
    </div>
    
    <div class="progress-bar-bg">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <div class="scene" id="scene" onclick="flipCard()">
        <div class="card" id="card">
            <div class="face front">
                <div class="tag" id="qTag">Kategorie</div>
                <h2 id="qText">Frage laden...</h2>
                <div class="tap-hint">Tippen zum Aufl√∂sen</div>
            </div>
            <div class="face back">
                <div class="tag">L√∂sung</div>
                <p id="aText">Antwort...</p>
            </div>
        </div>
    </div>

    <div class="controls" id="controls">
        <button class="btn btn-wrong" onclick="processAnswer(false)">
            <span>Falsch</span>
            <span style="font-size: 10px; opacity: 0.6; margin-top: 4px;">Leben verlieren</span>
        </button>
        <button class="btn btn-right" onclick="processAnswer(true)">
            <span>Richtig</span>
            <span style="font-size: 10px; opacity: 0.8; margin-top: 4px;">Punkte + Combo</span>
        </button>
    </div>

    <div class="overlay" id="startScreen" style="display: flex;">
        <h1>Jura Arcade</h1>
        <p>Montag ist Klausur. <br>Der Survival-Modus f√ºr √ñffentliches Recht.</p>
        <p style="font-size: 14px;">5 Leben. Highscore-Jagd. <br>Falsche Antworten kommen sofort zur√ºck.</p>
        <button class="big-btn" onclick="startGame()">Starten</button>
    </div>

    <div class="overlay" id="gameOverScreen">
        <h1 style="color: var(--red);">Game Over</h1>
        <p>Du hast alle Leben verloren.</p>
        <h2 id="finalScoreLose">0 Punkte</h2>
        <button class="big-btn" onclick="startGame()">Neu versuchen</button>
    </div>

    <div class="overlay" id="winScreen">
        <h1 style="color: var(--green);">Bestanden!</h1>
        <p>Du hast den Stoff f√ºr Montag drauf.</p>
        <h2 id="finalScoreWin">0 Punkte</h2>
        <button class="big-btn" onclick="startGame()">Nochmal zur Sicherheit</button>
    </div>

    <script>
        // --- DATA ---
        const questions = [
            { cat: "Aufgabe 1", q: "Was ist Systematische Auslegung?", a: "Feststellen des Aussagegehaltes einer Norm anhand ihrer Stellung im Gesetz oder im Gesamtzusammenhang." },
            { cat: "Aufgabe 1 (Alt)", q: "Was ist Historische Auslegung?", a: "Ermittlung des Willens des historischen Gesetzgebers anhand der Entstehungsgeschichte (Gesetzesmaterialien, Protokolle)." },
            { cat: "Aufgabe 2", q: "Was ist verfassungskonforme Auslegung?", a: "Wenn mehrere Deutungen m√∂glich sind: Die w√§hlen, die mit dem GG vereinbar ist. Norm bleibt g√ºltig." },
            { cat: "Aufgabe 2 (Alt)", q: "Was ist richtlinienkonforme Auslegung?", a: "Auslegung nationalen Rechts so, dass das Ziel einer EU-Richtlinie bestm√∂glich erreicht wird." },
            { cat: "Aufgabe 3", q: "Was ist eine Staatszielbestimmung? (+Beispiel)", a: "Verfassungsnorm, die dem Staat Aufgaben vorgibt ohne subjektive Rechte f√ºr Einzelne (z.B. Sozialstaat, Umweltschutz)." },
            { cat: "Aufgabe 4", q: "Definition: Anstalt (√ñff. Recht)", a: "Zusammenfassung von Personal/Sachen zur Erf√ºllung √∂ffentlicher Aufgaben, die BENUTZERN zur Verf√ºgung steht." },
            { cat: "Aufgabe 4 (Alt)", q: "Unterschied K√∂rperschaft vs. Anstalt", a: "K√∂rperschaft hat MITGLIEDER. Anstalt hat BENUTZER." },
            { cat: "Aufgabe 5", q: "Wo werden Bundesgesetze ver√∂ffentlicht?", a: "Im Bundesgesetzblatt." },
            { cat: "Aufgabe 6", q: "Warum ist bei komm. Zusammenarbeit der Verwaltungsrechtsweg (¬ß 40 VwGO) er√∂ffnet?", a: "Weil es um origin√§re √∂ffentliche Interessen geht und Gemeinden als Hoheitstr√§ger berechtigt sind (Modifizierte Subjektstheorie)." },
            { cat: "Aufgabe 7a", q: "Windkraft: Welcher Rechtsakt ist die Genehmigung?", a: "Ein Verwaltungsakt i.S.v. ¬ß 35 VwVfG." },
            { cat: "Aufgabe 7a", q: "Windkraft: Statthafte Klageart & Rechtsbehelf?", a: "Anfechtungsklage (¬ß 42 VwGO). Vorgeschaltet: Widerspruch (¬ß 68 VwGO)." },
            { cat: "Aufgabe 7a", q: "Windkraft: Wann ist der Nachbar klagebefugt?", a: "Wenn die M√ñGLICHKEIT einer Rechtsverletzung besteht (z.B. Art. 14 GG Eigentum oder Art. 12 GG)." },
            { cat: "Aufgabe 7b", q: "Windkraft: Worauf beruft sich eine Gemeinde bei Klage?", a: "Auf die kommunale Selbstverwaltungsgarantie / Planungshoheit (Art. 28 Abs. 2 GG)." },
            { cat: "Aufgabe 8", q: "Welche Normart ist ¬ß 87 I TKG (Ziele)?", a: "Final gefasste Norm (Gibt Ziel/Rechtsfolge vor)." },
            { cat: "Aufgabe 8", q: "Welche Normart ist ¬ß 110 I TKG (Wenn-Dann)?", a: "Konditional gefasste Norm." },
            { cat: "Aufgabe 8", q: "Welche Normart ist ¬ß 3 Nr. 20 TKG (Begriff)?", a: "Deskriptiv gefasste Norm (Definition)." },
            { cat: "Aufgabe 9", q: "Sind Gesch√§ftsr√§ume als 'Wohnung' (Art. 13 GG) gesch√ºtzt?", a: "Ja. Aber w√§hrend √ñffnungszeiten geringerer Schutz, erst nach Ladenschluss voller Schutz." },
            { cat: "Aufgabe 10", q: "Kann sich der Staat (ZDF) auf Grundrechte berufen?", a: "Grundsatz: Nein (Konfusionsargument). Ausnahme: Wenn grundrechtlich gesch√ºtzter Lebensbereich (Rundfunkfreiheit)." },
            { cat: "Aufgabe 10", q: "Gebote f√ºr Rundfunk-Aufsichtsgremien?", a: "1. Vielfaltsicherung (Spiegelbild der Gesellschaft). 2. Staatsferne (max 1/3 Staat)." },
            { cat: "Aufgabe 11", q: "Beispiel f√ºr Demokratieprinzip im GG", a: "Art. 20 Abs. 1 und 2 GG (Wahlen / Volkssouver√§nit√§t)." },
            { cat: "Aufgabe 12", q: "Wer hat Kompetenz f√ºr 'Corona-Notbremse'?", a: "Der Bund (Art. 74 GG, Ma√ünahmen gegen gemeingef√§hrliche Krankheiten)." },
            { cat: "Aufgabe 13", q: "Nenne 2 EU-Grundfreiheiten (+Artikel)", a: "Warenverkehr (Art. 28 AEUV), Arbeitnehmerfreiz√ºgigkeit (Art. 45), Dienstleistung (Art. 56)." },
            { cat: "Aufgabe 14", q: "Anspruchsgrundlage Amtshaftung (Schadenersatz)", a: "¬ß 839 BGB i.V.m. Art. 34 GG (Verletzung drittgerichteter Amtspflicht)." },
            { cat: "Aufgabe 15", q: "Definition Verwaltungsakt (¬ß 35 VwVfG)", a: "Hoheitliche Ma√ünahme einer Beh√∂rde auf Gebiet des √∂ff. Rechts zur Regelung eines Einzelfalls mit Au√üenwirkung." },
            { cat: "Aufgabe 16", q: "Nenne einen Ermessensfehler", a: "Ermessensnichtgebrauch, Ermessens√ºberschreitung oder Ermessensfehlgebrauch (sachfremde Erw√§gungen)." },
            { cat: "Aufgabe 17", q: "Aufhebung eines rechtm√§√üigen VA (Fachbegriff + Norm)", a: "Widerruf nach ¬ß 49 VwVfG." },
            { cat: "Aufgabe 18", q: "Wann gelten EU-Richtlinien unmittelbar?", a: "Wenn Frist abgelaufen, inhaltlich unbedingt, hinreichend bestimmt und Beg√ºnstigung des B√ºrgers." },
            { cat: "Aufgabe 19", q: "Woher kommen EU-Grundrechte?", a: "Art. 6 EUV referenziert auf: EU-Grundrechtecharta, EMRK und gemeinsame Verfassungs√ºberlieferungen." },
            { cat: "Aufgabe 20", q: "Rechtsgrundlage gegen Busunternehmer (Unzuverl√§ssig)", a: "Widerruf der Genehmigung nach ¬ß 25 PBefG (Personenbef√∂rderungsgesetz). NICHT GewO!" },
            { cat: "Aufgabe 20", q: "Voraussetzungen Widerruf ¬ß 25 PBefG", a: "1. Wegfall Genehmigungsvoraussetzungen, 2. Konkrete Tatsachen, 3. Unzuverl√§ssigkeit (negative Prognose)." }
        ];

        // --- GAME STATE ---
        let deck = [];
        let lives = 5;
        let score = 0;
        let combo = 0;
        let isFlipped = false;
        let currentCard = null;
        let maxCards = 0;

        // --- DOM ---
        const cardEl = document.getElementById('card');
        const controls = document.getElementById('controls');
        const qText = document.getElementById('qText');
        const aText = document.getElementById('aText');
        const qTag = document.getElementById('qTag');
        const livesDisplay = document.getElementById('livesDisplay');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const comboDisplay = document.getElementById('comboDisplay');
        const progressFill = document.getElementById('progressFill');

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function updateHUD() {
            // Lives
            let heartString = "";
            for(let i=0; i<lives; i++) heartString += "‚ù§Ô∏è";
            livesDisplay.innerText = heartString || "üíÄ";

            // Score
            scoreDisplay.innerText = score;

            // Combo
            if (combo > 1) {
                comboDisplay.innerText = "COMBO x" + combo;
                comboDisplay.classList.add('active');
            } else {
                comboDisplay.classList.remove('active');
            }

            // Progress
            let progress = ((maxCards - deck.length) / maxCards) * 100;
            if(deck.length === 0 && currentCard === null) progress = 100;
            progressFill.style.width = progress + "%";
        }

        function startGame() {
            document.querySelectorAll('.overlay').forEach(el => el.style.display = 'none');
            
            // Reset State
            deck = shuffle([...questions]);
            maxCards = questions.length;
            lives = 5;
            score = 0;
            combo = 0;
            
            updateHUD();
            drawCard();
        }

        function drawCard() {
            if (deck.length === 0) {
                endGame(true);
                return;
            }

            currentCard = deck.shift();
            isFlipped = false;

            // Reset CSS
            cardEl.classList.remove('flipped');
            controls.classList.remove('active');
            
            // Fill Content with slight delay for transition
            setTimeout(() => {
                qTag.innerText = currentCard.cat;
                qText.innerText = currentCard.q;
                aText.innerText = currentCard.a;
            }, 200);

            updateHUD();
        }

        function flipCard() {
            if (isFlipped) return;
            cardEl.classList.add('flipped');
            controls.classList.add('active');
            isFlipped = true;
        }

        function processAnswer(correct) {
            if (!isFlipped) return;

            if (correct) {
                // Logic
                combo++;
                let points = 10 * (combo > 1 ? combo : 1);
                score += points;
                
                // Visuals
                document.body.style.backgroundColor = "#E8F5E9"; // Green tint
                setTimeout(() => document.body.style.backgroundColor = "#F2F2F7", 300);
                
                nextTurn();

            } else {
                // Logic
                lives--;
                combo = 0;
                
                // Punishment: Card goes back into deck (at index 2 or end)
                let reinsertIndex = Math.min(deck.length, 2);
                deck.splice(reinsertIndex, 0, currentCard);
                maxCards++; // Increase max to reflect added work
                
                // Visuals
                document.body.style.backgroundColor = "#FFEBEE"; // Red tint
                document.getElementById('scene').classList.add('shake');
                setTimeout(() => {
                    document.body.style.backgroundColor = "#F2F2F7";
                    document.getElementById('scene').classList.remove('shake');
                }, 400);

                if (lives <= 0) {
                    endGame(false);
                } else {
                    nextTurn();
                }
            }
        }

        function nextTurn() {
            setTimeout(() => {
                drawCard();
            }, 400);
        }

        function endGame(won) {
            if (won) {
                document.getElementById('finalScoreWin').innerText = score + " Punkte";
                document.getElementById('winScreen').style.display = 'flex';
                // Simple Confetti Effect via JS could go here
            } else {
                document.getElementById('finalScoreLose').innerText = score + " Punkte";
                document.getElementById('gameOverScreen').style.display = 'flex';
            }
        }

    </script>
</body>
</html>
